# Система капчи для регистрации

## Описание

В проект AnotherWoW добавлена система математической капчи для защиты формы регистрации от автоматических регистраций ботов.

## Компоненты

### CaptchaService (src/services/CaptchaService.php)
Основной класс для работы с капчей:

- `generateMathCaptcha()` - генерирует математическое выражение
- `generateAndStoreCaptcha()` - генерирует капчу и сохраняет в сессию
- `verifyCaptcha($answer)` - проверяет ответ пользователя
- `clearCaptcha()` - очищает капчу из сессии

### Обновленный RegisterController
- При отображении формы автоматически генерируется новая капча
- При обработке формы проверяется правильность ответа
- При ошибках генерируется новая капча

### Обновленная форма регистрации
- Добавлено поле для ввода ответа на математический пример
- Добавлена стилизация для лучшего отображения
- Подключен JavaScript для улучшения UX

## Принцип работы

1. При загрузке страницы регистрации генерируется случайный математический пример (сложение или вычитание чисел от 1 до 10)
2. Пример и правильный ответ сохраняются в сессии пользователя
3. При отправке формы проверяется введенный ответ
4. Капча действительна в течение 5 минут
5. После успешной проверки или при ошибке капча очищается и генерируется новая

## Особенности

- **Простота**: использует только математические операции сложения и вычитания
- **Безопасность**: ответ хранится только на сервере в сессии
- **Удобство**: автоматическая генерация новой капчи при ошибках
- **Защита**: истечение времени действия капчи (5 минут)
- **UX**: JavaScript-валидация и улучшения интерфейса

## Настройки

Время действия капчи можно изменить в методе `verifyCaptcha()` класса `CaptchaService`:
```php
// Проверяем, что капча не истекла (5 минут = 300 секунд)
if (time() - $_SESSION['captcha_time'] > 300) {
```

## Тестирование

Создан файл `test_captcha.php` для тестирования работы системы капчи.

## Стили

Добавлены CSS-стили в `public/css/style.css`:
- `.captcha-question` - стиль для отображения математического примера
- `input[type="number"]` - стиль для поля ввода ответа

## JavaScript

Добавлен файл `public/js/captcha.js` с функциями:
- Автофокус на поле капчи
- Валидация формы
- Улучшение UX взаимодействия